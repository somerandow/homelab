machine:
  certSANs:
    - 127.0.0.1
    - 10.0.0.8
    - 10.4.0.8
  install:
    wipe: true
    diskSelector:
      model: KINGSTON OM8PGP41024N-A0 # TODO: Change this to point to NVMe namespace
  systemDiskEncryption:
    ephemeral:
      provider: luks2
      cipher: aes-xts-plain64
      keySize: 256
      lockToState: true
      keys:
        - tpm: { }
          slot: 0
    state:
      provider: luks2
      cipher: aes-xts-plain64
      keySize: 256
      keys:
        - tpm: { }
          slot: 0
  network:
    hostname: worker-2
    searchDomains:
      - wojoinc.xyz
    interfaces:
      - interface: enp87s0
        addresses:
          - 10.0.0.8/24
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.0.1
            metric: 1024
      - interface: enp2s0f0np0
        addresses:
          - 10.4.0.8/16
---
# TODO: Remove, should no longer be necessary
apiVersion: v1alpha1
kind: UserVolumeConfig
name: ceph-data
$patch: delete
---
# TODO: Remove, this will be handled by NVMe namespacing
apiVersion: v1alpha1
kind: RawVolumeConfig
name: extra-os-disk
provisioning:
  diskSelector:
    match: disk.model == "KINGSTON OM8PGP41024N-A0"
  minSize: 100GB
  grow: true
---
apiVersion: v1alpha1
kind: VolumeConfig
name: EPHEMERAL
provisioning:
  diskSelector:
    match: disk.model == "KINGSTON OM8PGP41024N-A0" # TODO: Update to proper NVMe namespace ID
  minSize: 100GB
  maxSize: 200GB
  grow: true
